---
import type { FavoriteItem } from '../types'

interface Props {
  item: FavoriteItem
  gradientFrom: string
  gradientTo: string
  iconColor: string
  iconPath: string
}

const { item, gradientFrom, gradientTo, iconColor, iconPath } = Astro.props
const hasLink = !!item.link
const base = import.meta.env.BASE_URL
---

{hasLink ? (
  <a href={item.link} target="_blank" rel="noopener noreferrer" class="block group favorite-card bg-white/70 dark:bg-slate-800/80 backdrop-blur-sm rounded-xl overflow-hidden shadow-md shadow-slate-200/40 dark:shadow-none dark:border dark:border-slate-700/50 card-hover cursor-pointer">
    <div class={`aspect-video bg-gradient-to-br ${gradientFrom} ${gradientTo} flex items-center justify-center overflow-hidden img-skeleton-wrapper`}>
      {item.cover ? (
        <div class="img-skeleton skeleton"></div>
        <img
          src={base + item.cover}
          alt={item.name}
          class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
          loading="lazy"
          onload="this.previousElementSibling.classList.add('loaded')"
          onerror="this.style.display='none';this.previousElementSibling.classList.add('loaded');this.nextElementSibling.style.display='flex';"
        />
        <div class="w-full h-full items-center justify-center hidden">
          <svg class={`w-12 h-12 ${iconColor}`} fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d={iconPath} />
          </svg>
        </div>
      ) : (
        <svg class={`w-12 h-12 ${iconColor}`} fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d={iconPath} />
        </svg>
      )}
    </div>
    <div class="p-4">
      <h4 class="font-medium text-slate-800 dark:text-white text-sm mb-2 line-clamp-2">{item.name}</h4>
      <div class="card-comment-wrapper">
        <p class="card-comment text-xs text-slate-500 dark:text-slate-300">{item.comment}</p>
      </div>
    </div>
  </a>
) : (
  <div class="group favorite-card bg-white/70 dark:bg-slate-800/80 backdrop-blur-sm rounded-xl overflow-hidden shadow-md shadow-slate-200/40 dark:shadow-none dark:border dark:border-slate-700/50 card-hover cursor-pointer">
    <div class={`aspect-video bg-gradient-to-br ${gradientFrom} ${gradientTo} flex items-center justify-center overflow-hidden img-skeleton-wrapper`}>
      {item.cover ? (
        <div class="img-skeleton skeleton"></div>
        <img
          src={base + item.cover}
          alt={item.name}
          class="w-full h-full object-cover"
          loading="lazy"
          onload="this.previousElementSibling.classList.add('loaded')"
          onerror="this.style.display='none';this.previousElementSibling.classList.add('loaded');this.nextElementSibling.style.display='flex';"
        />
        <div class="w-full h-full items-center justify-center hidden">
          <svg class={`w-12 h-12 ${iconColor}`} fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d={iconPath} />
          </svg>
        </div>
      ) : (
        <svg class={`w-12 h-12 ${iconColor}`} fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d={iconPath} />
        </svg>
      )}
    </div>
    <div class="p-4">
      <h4 class="font-medium text-slate-800 dark:text-white text-sm mb-2 line-clamp-2">{item.name}</h4>
      <div class="card-comment-wrapper">
        <p class="card-comment text-xs text-slate-500 dark:text-slate-300">{item.comment}</p>
      </div>
    </div>
  </div>
)}
